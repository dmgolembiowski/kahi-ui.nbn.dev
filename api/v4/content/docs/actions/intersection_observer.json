{"data":{"metadata":{"authors":{},"created_at":1633108516000,"identifier":"/docs/actions/intersection_observer","modified_at":1645838554000,"sections":[{"identifier":"intersection_observer","level":1,"text":"intersection_observer"},{"identifier":"imports","level":2,"text":"Imports"},{"identifier":"compatibility","level":2,"text":"Compatibility"}],"snippets":[{"identifier":"intersection_observer-preview","script":"<script>\n    import {\n        Box,\n        Code,\n        Spacer,\n        Transition,\n        intersection_observer,\n    } from \"@kahi-ui/framework\";\n\n    let is_intersecting = false;\n</script>\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<Box\n    palette={is_intersecting\n        ? \"affirmative\"\n        : \"negative\"}\n    padding=\"small\"\n>\n    Scroll down to watch this <Code>Box</Code> change when\n    the <Code>Box</Code> comes into view.\n</Box>\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<div\n    class=\"intersection-observer-preview\"\n    use:intersection_observer={{\n        threshold: 0.5,\n        on_intersect: (intersections) => {\n            console.log(\"on_intersect\", {\n                intersections,\n            });\n\n            is_intersecting = intersections.some(\n                (intersection) =>\n                    intersection.isIntersecting\n            );\n        },\n    }}\n>\n    {#if is_intersecting}\n        <Transition\n            animation=\"scale\"\n            variation=\"enter\"\n        >\n            <Box\n                class=\"intersection-observer-preview\"\n                palette=\"inverse\"\n                padding=\"small\">I am in view!</Box\n            >\n        </Transition>\n    {/if}\n</div>\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<Box\n    palette={is_intersecting\n        ? \"affirmative\"\n        : \"negative\"}\n    padding=\"small\"\n>\n    Scroll up to watch this <Code>Box</Code> change when\n    the <Code>Box</Code> comes into view.\n</Box>\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<Spacer spacing=\"huge\" />\n<Spacer spacing=\"huge\" />\n\n<style>\n    :global(.intersection-observer-preview) {\n        height: 40px;\n    }\n</style>","syntax":"svelte","title":"intersection_observer Preview"},{"identifier":"intersection_observer-imports","script":"import {intersection_observer} from \"@kahi-ui/framework\";","syntax":"javascript","title":"intersection_observer Imports"}],"title":"intersection_observer"},"text":"intersection_observer NOTE : Introduced feature in v0.4.1. intersection_observer is a Svelte Action , which runs a on_intersect(intersections: IntersectionObserverEntry[]): void callback whenever the targetted element intersects the root viewport. NOTE : The below REPL basically reimplements IntersectionRender . <script> import { Box, Code, Spacer, Transition, intersection_observer, } from \"@kahi-ui/framework\"; let is_intersecting = false; </script> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Box palette={is_intersecting ? \"affirmative\" : \"negative\"} padding=\"small\" > Scroll down to watch this <Code>Box</Code> change when the <Code>Box</Code> comes into view. </Box> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <div class=\"intersection-observer-preview\" use:intersection_observer={{ threshold: 0.5, on_intersect: (intersections) => { console.log(\"on_intersect\", { intersections, }); is_intersecting = intersections.some( (intersection) => intersection.isIntersecting ); }, }} > {#if is_intersecting} <Transition animation=\"scale\" variation=\"enter\" > <Box class=\"intersection-observer-preview\" palette=\"inverse\" padding=\"small\">I am in view!</Box > </Transition> {/if} </div> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Box palette={is_intersecting ? \"affirmative\" : \"negative\"} padding=\"small\" > Scroll up to watch this <Code>Box</Code> change when the <Code>Box</Code> comes into view. </Box> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <Spacer spacing=\"huge\" /> <style> :global(.intersection-observer-preview) { height: 40px; } </style> Imports import {intersection_observer} from \"@kahi-ui/framework\"; Compatibility Svelte Actions are always ran on Javascript-enabled Browser. So should not be used for critical end-user functionality, only progressive enhancement. The Action is dependent on IntersectionObserver . ","references":{"custom_properties":{},"events":{},"properties":{},"slots":{}},"render":"<blockquote data-palette=\"accent\">\n<p><strong>NOTE</strong>: Introduced feature in <code>v0.4.1</code>.</p>\n</blockquote>\n<p><code>intersection_observer</code> is a <a href=\"https://svelte.dev/docs#use_action\" target=\"_blank\" rel=\"noopener noreferrer\">Svelte Action</a>, which runs a <code>on_intersect(intersections: IntersectionObserverEntry[]): void</code> callback whenever the targetted element intersects the root viewport.</p>\n<blockquote data-palette=\"accent\">\n<p><strong>NOTE</strong>: The below REPL basically reimplements <a href=\"../utilities/intersectionrender\" svelte:prefetch=\"true\">IntersectionRender</a>.</p>\n</blockquote>\n<pre class=\"highlight language-svelte\" data-identifier=\"intersection_observer-preview\" data-mode=\"repl\" data-syntax=\"svelte\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n    <span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n        Box<span class=\"token punctuation\">,</span>\n        Code<span class=\"token punctuation\">,</span>\n        Spacer<span class=\"token punctuation\">,</span>\n        Transition<span class=\"token punctuation\">,</span>\n        intersection_observer<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@kahi-ui/framework\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> is_intersecting <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Box</span>\n    <span class=\"token attr-name\">palette=</span><span class=\"token language-javascript\"><span class=\"token punctuation\">{</span>is_intersecting\n        <span class=\"token operator\">?</span> <span class=\"token string\">\"affirmative\"</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"negative\"</span><span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">padding</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>small<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">></span></span>\n    Scroll down to watch this <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Code</span><span class=\"token punctuation\">></span></span>Box<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Code</span><span class=\"token punctuation\">></span></span> change when\n    the <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Code</span><span class=\"token punctuation\">></span></span>Box<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Code</span><span class=\"token punctuation\">></span></span> comes into view.\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Box</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span>\n    <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>intersection-observer-preview<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\"><span class=\"token namespace\">use:</span>intersection_observer</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{</span><span class=\"token language-javascript\"><span class=\"token punctuation\">{</span>\n        threshold<span class=\"token operator\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">on_intersect</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">intersections</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"on_intersect\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n                intersections<span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            is_intersecting <span class=\"token operator\">=</span> intersections<span class=\"token punctuation\">.</span><span class=\"token function\">some</span><span class=\"token punctuation\">(</span>\n                <span class=\"token punctuation\">(</span><span class=\"token parameter\">intersection</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n                    intersection<span class=\"token punctuation\">.</span>isIntersecting\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span></span><span class=\"token attr-name\">}</span>\n<span class=\"token punctuation\">></span></span>\n    <span class=\"token language-javascript\"><span class=\"token punctuation\">{</span>#<span class=\"token keyword\">if</span> is_intersecting<span class=\"token punctuation\">}</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Transition</span>\n            <span class=\"token attr-name\">animation</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>scale<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">variation</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>enter<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Box</span>\n                <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>intersection-observer-preview<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token attr-name\">palette</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>inverse<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token attr-name\">padding</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>small<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>I am in view!<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Box</span>\n            <span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Transition</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token language-javascript\"><span class=\"token punctuation\">{</span><span class=\"token operator\">/</span><span class=\"token keyword\">if</span><span class=\"token punctuation\">}</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Box</span>\n    <span class=\"token attr-name\">palette=</span><span class=\"token language-javascript\"><span class=\"token punctuation\">{</span>is_intersecting\n        <span class=\"token operator\">?</span> <span class=\"token string\">\"affirmative\"</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"negative\"</span><span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">padding</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>small<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">></span></span>\n    Scroll up to watch this <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Code</span><span class=\"token punctuation\">></span></span>Box<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Code</span><span class=\"token punctuation\">></span></span> change when\n    the <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Code</span><span class=\"token punctuation\">></span></span>Box<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Code</span><span class=\"token punctuation\">></span></span> comes into view.\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Box</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Spacer</span> <span class=\"token attr-name\">spacing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>huge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n    <span class=\"token selector\">:global(.intersection-observer-preview)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 40px<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span></code></pre><h2 id=\"imports\">Imports</h2>\n<pre class=\"highlight language-javascript\" data-identifier=\"intersection_observer-imports\" data-mode=\"default\" data-syntax=\"javascript\"><code><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>intersection_observer<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@kahi-ui/framework\"</span><span class=\"token punctuation\">;</span></code></pre><h2 id=\"compatibility\">Compatibility</h2>\n<p>Svelte Actions are always ran on Javascript-enabled Browser. So should not be used for critical end-user functionality, only progressive enhancement. The Action is dependent on <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver\" target=\"_blank\" rel=\"noopener noreferrer\"><code>IntersectionObserver</code></a>.</p>\n"}}